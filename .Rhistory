occupancy <- ts(matherM$occupancy, frequency = 12, start = c(2007, 3), end = c(2017, 12))
window1 <- window(occupancy, start=c(2017,11))
window2 <- window(occupancy, start=c(2017,9))
window3 <- window(occupancy, start=c(2017,6))
window4 <- window(occupancy, start=c(2016,12))
MA <- ma(window, 3)
MA <- ma(window1, 3)
MA <- ma(window2, 3)
accuracy(ma(window2, 3),occupancy)
ggplot(matherM, aes(month, occupancy, color = "Data")) +
geom_line(stat="identity") +
geom_line(data=MA, aes()) +
scale_x_date(labels = date_format("%b/%y")) +
scale_fill_gradient(breaks=unique(matherM$year))
ggplot(matherM, aes(month, occupancy)) +
geom_line(stat="identity") +
geom_line(data=MA, aes()) +
scale_x_date(labels = date_format("%b/%y")) +
scale_fill_gradient(breaks=unique(matherM$year))
ggplot(matherM, aes(month, occupancy, color = "Data")) +
geom_line() +
geom_line(data=MA, aes()) +
scale_x_date(labels = date_format("%b/%y")) +
scale_fill_gradient(breaks=unique(matherM$year))
ggplot(matherM, aes(month, occupancy, color = "Data")) +
geom_line() +
geom_line(data=MA, aes(month, occupancy, color = "MA")) +
scale_x_date(labels = date_format("%b/%y")) +
scale_fill_gradient(breaks=unique(matherM$year))
ggplot(matherM, aes(month, occupancy, color = "Data")) +
geom_line() +
geom_line(data=MA, aes(month, occupancy, color = "MA")) +
scale_x_date(labels = date_format("%b/%y"))
a <- autoplot(occupancy, type = "obs", mapping = aes(color="Data", linetype="Data")) +
autolayer(ma(Window,3), PI=FALSE) +
xlab("") + ylab("Occupancy (%)")  +
scale_color_manual(
name = "Data",
values = c(Data = "dimgrey", MA = "firebrick")) +
scale_linetype_manual(
name = "Data",
values = c(Data = "dashed", MA = "solid")) +
scale_y_continuous(breaks=seq(0,100,25))  +
ggtitle("Mather Campground") +
theme(panel.background = element_blank())
a
a <- autoplot(occupancy, type = "obs", mapping = aes(color="Data", linetype="Data")) +
autolayer(ma(window3,3), PI=FALSE) +
xlab("") + ylab("Occupancy (%)")  +
scale_color_manual(
name = "Data",
values = c(Data = "dimgrey", MA = "firebrick")) +
scale_linetype_manual(
name = "Data",
values = c(Data = "dashed", MA = "solid")) +
scale_y_continuous(breaks=seq(0,100,25))  +
ggtitle("Mather Campground") +
theme(panel.background = element_blank())
a
occupancy <- ts(matherM$occupancy, frequency = 12, start = c(2007, 3), end = c(2017, 12))
train <- window(occupancy, end=c(2015,12))
h <- length(occupancy) - length(train)
arf <- arfima(train, order = c(4,0,1), numeach = c(3,3))
occupancy <- ts(elkmontM$occupancy, frequency = 12, start = c(2007, 3))
train <- window(occupancy, end=c(2015,12))
h <- length(occupancy) - length(train)
NNAR <- forecast(nnetar(train), h=h)
occupancy <- ts(elkmontM$occupancy, frequency = 12, start = c(2007, 3), end = c(2017, 12))
train <- window(occupancy, end=c(2015,12))
h <- length(occupancy) - length(train)
NNAR <- forecast(nnetar(train), h=h)
nn <- nnetar(train)
NNAR <- forecast(nn, h=h)
NNAR <- forecast(nn, h=24)
NNAR <- forecast(nn)
n_date <- unique(matherM[, month])
period <- 48
period <- 12
theme_ts <- theme(panel.border = element_rect(fill = NA,
colour = "grey10"),
panel.background = element_blank(),
panel.grid.minor = element_line(colour = "grey85"),
panel.grid.major = element_line(colour = "grey85"),
panel.grid.major.x = element_line(colour = "grey85"),
axis.text = element_text(size = 13, face = "bold"),
axis.title = element_text(size = 15, face = "bold"),
plot.title = element_text(size = 16, face = "bold"),
strip.text = element_text(size = 16, face = "bold"),
strip.background = element_rect(colour = "black"),
legend.text = element_text(size = 15),
legend.title = element_text(size = 16, face = "bold"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white"))
data_train <- matherM[date %in% n_date[1:105]]
data_test <- matherM[date %in% n_date[106]]
ggplot(data_train, aes(date_time, value)) +
geom_line() +
labs(x = "Date", y = "Load (kW)") +
theme_ts
data_train <- matherM[month %in% n_date[1:105]]
data_test <- matherM[month %in% n_date[106]]
ggplot(data_train, aes(month, occupancy)) +
geom_line() +
labs(x = "Date", y = "Load (kW)") +
theme_ts
formatCamp <- function(ID){
n=ID
name <- data[data$id==n & as.Date(data$date, format="%Y-%m-%d")<"2018-01-01",]
name$date <- as.Date(name$date, format = "%Y-%m-%d")
min <- as.Date(min(name$date))
max <- as.Date(max(name$date))
name1 <- name %>%
complete(date = seq(min, max, by="day")) %>%
mutate(Campground = na.locf(Campground, na.rm=FALSE)) %>%
mutate(Park = na.locf(Park, na.rm=FALSE)) %>%
mutate(id = na.locf(id, na.rm=FALSE)) %>%
mutate(occupancy = replace_na(occupancy, 0)) %>%
mutate(avgfee = replace_na(avgfee, 0)) %>%
mutate(aggPaid = replace_na(aggPaid, 0)) %>%
mutate(avgPaid = replace_na(avgPaid, 0)) %>%
mutate(avgNumberOfPeople = replace_na(avgNumberOfPeople, 0)) %>%
mutate(totalNumberOfPeople = replace_na(totalNumberOfPeople, 0)) %>%
mutate(avgdateDiff = replace_na(avgdateDiff, 0)) %>%
mutate(avglengthStay = replace_na(avglengthStay, 0)) %>%
mutate(numOfSites = na.locf(numOfSites, na.rm=FALSE)) %>%
mutate(recGovNumOfSites = na.locf(recGovNumOfSites, na.rm=FALSE)) %>%
mutate(occupancy = 100*occupancy) %>%
distinct(date, .keep_all=TRUE)
fwrite(name, paste0("descriptive_", ID, ".csv"))
fwrite(name1, paste0("campground_", ID, ".csv"))
name$month <- format(as.Date(name$date, format = "%Y-%m-%d"), "%Y-%m")
nameM <- name %>%
group_by(month) %>%
mutate(totalNumberOfPeople = sum(totalNumberOfPeople)) %>%
mutate(avgNumberOfPeople = mean(avgNumberOfPeople)) %>%
mutate(occupancy = mean(occupancy)) %>%
mutate(avgPaid = sum(avgPaid)) %>%
mutate(avgfee = mean(avgfee)) %>%
mutate(avglengthStay = mean(avglengthStay)) %>%
mutate(avgdateDiff = mean(avgdateDiff)) %>%
distinct(month, .keep_all=TRUE)
nameM$month <- as.yearmon(nameM$month, "%Y-%m")
nameM$month <- as.Date(nameM$month)
fwrite(nameM, paste0("campground_monthly_", ID, ".csv"))
}
mather <- fread("campground_65.csv")
matherM <- fread("campground_monthly_65.csv")
formatCamp(65)
summary(mather)
formatCamp <- function(ID){
n=ID
name <- data[data$id==n & as.Date(data$date, format="%Y-%m-%d")<"2018-01-01",]
name$date <- as.Date(name$date, format = "%Y-%m-%d")
min <- as.Date(min(name$date))
max <- as.Date(max(name$date))
fwrite(name, paste0("descriptive_", ID, ".csv"))
name <- name %>%
complete(date = seq(min, max, by="day")) %>%
mutate(Campground = na.locf(Campground, na.rm=FALSE)) %>%
mutate(Park = na.locf(Park, na.rm=FALSE)) %>%
mutate(id = na.locf(id, na.rm=FALSE)) %>%
mutate(occupancy = replace_na(occupancy, 0)) %>%
mutate(avgfee = replace_na(avgfee, 0)) %>%
mutate(aggPaid = replace_na(aggPaid, 0)) %>%
mutate(avgPaid = replace_na(avgPaid, 0)) %>%
mutate(avgNumberOfPeople = replace_na(avgNumberOfPeople, 0)) %>%
mutate(totalNumberOfPeople = replace_na(totalNumberOfPeople, 0)) %>%
mutate(avgdateDiff = replace_na(avgdateDiff, 0)) %>%
mutate(avglengthStay = replace_na(avglengthStay, 0)) %>%
mutate(numOfSites = na.locf(numOfSites, na.rm=FALSE)) %>%
mutate(recGovNumOfSites = na.locf(recGovNumOfSites, na.rm=FALSE)) %>%
mutate(occupancy = 100*occupancy) %>%
distinct(date, .keep_all=TRUE)
fwrite(name, paste0("campground_", ID, ".csv"))
name$month <- format(as.Date(name$date, format = "%Y-%m-%d"), "%Y-%m")
nameM <- name %>%
group_by(month) %>%
mutate(totalNumberOfPeople = sum(totalNumberOfPeople)) %>%
mutate(avgNumberOfPeople = mean(avgNumberOfPeople)) %>%
mutate(occupancy = mean(occupancy)) %>%
mutate(avgPaid = sum(avgPaid)) %>%
mutate(avgfee = mean(avgfee)) %>%
mutate(avglengthStay = mean(avglengthStay)) %>%
mutate(avgdateDiff = mean(avgdateDiff)) %>%
distinct(month, .keep_all=TRUE)
nameM$month <- as.yearmon(nameM$month, "%Y-%m")
nameM$month <- as.Date(nameM$month)
fwrite(nameM, paste0("campground_monthly_", ID, ".csv"))
}
formatCamp(65)
mather <- fread("campground_65.csv")
summary(mather)
formatCamp(42)
elkmont <- fread("campground_42.csv")
summary(elkmont)
View(mather)
unique(data$id[data$Campground=="MATHER CAMPGROUND"]) #65
formatCamp(65)
matherD <- fread("descriptive_65.csv")
mather <- fread("campground_65.csv")
matherM <- fread("campground_monthly_65.csv")
unique(data$id[data$Campground=="MORAINE PARK CAMPGROUND"]) #67
formatCamp(67)
moraineD <- fread("descriptive_67.csv")
moraine <- fread("campground_67.csv")
moraineM <- fread("campground_monthly_67.csv")
unique(data$id[data$Campground=="UPPER PINES"]) #106
formatCamp(106)
upperD <- fread("descriptive_106.csv")
upper <- fread("campground_106.csv")
upperM <- fread("campground_monthly_106.csv")
unique(data$id[data$Campground=="BIG MEADOWS"]) #7
formatCamp(7)
meadowsD <- fread("descriptive_7.csv")
meadows <- fread("campground_7.csv")
meadowsM <- fread("campground_monthly_7.csv")
unique(data$id[data$Campground=="ELKMONT CAMPGROUND"]) #42
formatCamp(42)
elkmontD <- fread("descriptive_42.csv")
elkmont <- fread("campground_42.csv")
elkmontM <- fread("campground_monthly_42.csv")
#unique(data$id[data$Campground=="BLACKWOODS CAMPGROUND"]) #11
#formatCamp(11)
#black <- fread("campground_monthly_11.csv") #weird occupancy
#unique(data$id[data$Campground=="FLAMINGO"]) #45
#formatCamp(45)
#flamingo <- fread("campground_monthly_45.csv") #weird occupancy
n_date <- unique(matherM[, month])
period <- 12
data_train <- matherM[month %in% n_date[1:105]]
data_test <- matherM[month %in% n_date[106]]
ggplot(data_train, aes(month, occupancy)) +
geom_line() +
labs(x = "Date", y = "Load (kW)") +
theme_ts
ggplot(data_train, aes(month, occupancy, group=1)) +
geom_line() +
labs(x = "Date", y = "Load (kW)") +
theme_ts
data_ts <- ts(data_train$occupancy, freq = period * 7)
decomp_ts <- stl(data_ts, s.window = "periodic", robust = TRUE)$time.series
#install.packages(c("readr", "data.table", "psych","dplyr", "tidyr", "reshape2", "lubridate", "forecast", "astsa", "zoo", "nowcasting", "TSstudio", "ggplot2", "pastecs","readxl", "grid", "gridExtra", "kableExtra","knitr", "fpp2", "tstools", "tseries", "plotly", "scales","midasr"))
library(readr)
library(data.table)
library(psych)
library(dplyr)
library(tidyr)
library(reshape2)
library(lubridate)
library(forecast)
library(astsa)
library(zoo)
library(nowcasting)
library(TSstudio)
library(ggplot2)
library(pastecs)
library(readxl)
library(gridExtra)
library(grid)
library(kableExtra)
library(knitr)
library(fpp2)
library(tstools)
library(tseries)
library(plotly)
library(scales)
library(midasr)
library(tsfknn)
require("knitr")
opts_knit$set(root.dir = "~/Documents/GitHub/RIDB/data")
rm(list=ls())
#load functions
source("~/GitHub/RIDB/formatCamp.R")
opts_knit$set(root.dir = "~/Documents/GitHub/RIDB/data")
#install.packages(c("readr", "data.table", "psych","dplyr", "tidyr", "reshape2", "lubridate", "forecast", "astsa", "zoo", "nowcasting", "TSstudio", "ggplot2", "pastecs","readxl", "grid", "gridExtra", "kableExtra","knitr", "fpp2", "tstools", "tseries", "plotly", "scales","midasr"))
library(readr)
library(data.table)
library(psych)
library(dplyr)
library(tidyr)
library(reshape2)
library(lubridate)
library(forecast)
library(astsa)
library(zoo)
library(nowcasting)
library(TSstudio)
library(ggplot2)
library(pastecs)
library(readxl)
library(gridExtra)
library(grid)
library(kableExtra)
library(knitr)
library(fpp2)
library(tstools)
library(tseries)
library(plotly)
library(scales)
library(midasr)
library(tsfknn)
require("knitr")
opts_knit$set(root.dir = "~/Documents/GitHub/RIDB/data")
rm(list=ls())
#load functions
source("~/Documents/GitHub/RIDB/formatCamp.R")
source("~/Documents/GitHub/RIDB/unitTest.R")
source("~/Documents/GitHub/RIDB/campMGraph.R")
#load data
data <- fread("~/Documents/GitHub/RIDB/data/final_data.csv")
#unique(data$id[data$Campground=="MATHER CAMPGROUND"]) #65
formatCamp(65)
matherD <- fread("descriptive_65.csv")
mather <- fread("campground_65.csv")
matherM <- fread("campground_monthly_65.csv")
#unique(data$id[data$Campground=="MORAINE PARK CAMPGROUND"]) #67
formatCamp(67)
moraineD <- fread("descriptive_67.csv")
moraine <- fread("campground_67.csv")
moraineM <- fread("campground_monthly_67.csv")
#unique(data$id[data$Campground=="UPPER PINES"]) #106
formatCamp(106)
upperD <- fread("descriptive_106.csv")
upper <- fread("campground_106.csv")
upperM <- fread("campground_monthly_106.csv")
#unique(data$id[data$Campground=="BIG MEADOWS"]) #7
formatCamp(7)
meadowsD <- fread("descriptive_7.csv")
meadows <- fread("campground_7.csv")
meadowsM <- fread("campground_monthly_7.csv")
#unique(data$id[data$Campground=="ELKMONT CAMPGROUND"]) #42
formatCamp(42)
elkmontD <- fread("descriptive_42.csv")
elkmont <- fread("campground_42.csv")
elkmontM <- fread("campground_monthly_42.csv")
#unique(data$id[data$Campground=="BLACKWOODS CAMPGROUND"]) #11
#formatCamp(11)
#black <- fread("campground_monthly_11.csv") #weird occupancy
#unique(data$id[data$Campground=="FLAMINGO"]) #45
#formatCamp(45)
#flamingo <- fread("campground_monthly_45.csv") #weird occupancy
#for consistency, start all camp data from 2007 May
elkmontM <- elkmontM[which(elkmontM$month>"2007-04-01")]
matherM <- matherM[which(matherM$month>"2007-04-01")]
meadowsM <- meadowsM[which(meadowsM$month>"2007-04-01")]
moraineM <- moraineM[which(moraineM$month>"2007-04-01")]
upperM <- upperM[which(upperM$month>"2007-04-01")]
summary(meadowsD)
summary(elkmontD)
summary(matherD)
summary(moraineD)
summary(upperD)
#occupancy greater than 100%
dplyr::count(meadowsD[meadowsD$occupancy>1])/dplyr::count(meadowsD)
dplyr::count(elkmontD[elkmontD$occupancy>1])/dplyr::count(elkmontD)
dplyr::count(matherD[matherD$occupancy>1])/dplyr::count(matherD)
dplyr::count(moraineD[moraineD$occupancy>1])/dplyr::count(moraineD)
dplyr::count(upperD[upperD$occupancy>1])/dplyr::count(upperD)
#maximum occupancy
max(meadowsD$occupancy)
max(elkmontD$occupancy)
max(matherD$occupancy)
max(moraineD$occupancy)
max(upperD$occupancy)
rm(meadowsD, elkmontD, matherD, moraineD, upperD)
p1 <- campMGraph(mather, matherM)+ggtitle("Mather, Grand Canyon")
p2 <- campMGraph(elkmont, elkmontM)+ggtitle("Elkmont, Great Smoky Mountains")
p3 <- campMGraph(meadows, meadowsM)+ggtitle("Big Meadows, Shenandoah")
p4 <- campMGraph(moraine, moraineM)+ggtitle("Moraine, Rocky Mountain")
p5 <- campMGraph(upper, upperM)+ggtitle("Upper Pines, Yosemite")
jpeg('occupancy.jpg',
width = 800, height = 450, units = "px", pointsize = 11,
quality = 1000)
grid.arrange(p1, p2, p3, p4, p5, ncol=3, nrow=2)
dev.off()
p1 <- campMGraph(mather, matherM)+ggtitle("Mather, Grand Canyon")
p2 <- campMGraph(elkmont, elkmontM)+ggtitle("Elkmont, Great Smoky Mountains")
p3 <- campMGraph(meadows, meadowsM)+ggtitle("Big Meadows, Shenandoah")
p4 <- campMGraph(moraine, moraineM)+ggtitle("Moraine, Rocky Mountain")
p5 <- campMGraph(upper, upperM)+ggtitle("Upper Pines, Yosemite")
tiff('occupancy.tiff',
width = 800, height = 450, units = "px", pointsize = 11)
grid.arrange(p1, p2, p3, p4, p5, ncol=3, nrow=2)
dev.off()
tiff('occupancy.tiff',
width = 800, height = 450, units = "px", pointsize = 11, res = 500)
grid.arrange(p1, p2, p3, p4, p5, ncol=3, nrow=2)
grid.arrange(p1, p2, p3, p4, p5, ncol=3, nrow=2)
pdf("occupancy.pdf", 7, 5)
grid.arrange(p1, p2, p3, p4, p5, ncol=3, nrow=2)
dev.off()
pdf("occupancy.pdf", 16, 9)
grid.arrange(p1, p2, p3, p4, p5, ncol=3, nrow=2)
dev.off()
source("~/GitHub/RIDB/combProcess2.R")
source("~/Documents/GitHub/RIDB/combProcess2.R")
b<-combProcess2(elkmontM, 6)
c<-combProcess2(matherM, 6)
a<-combProcess2(meadowsM, 6)
d<-combProcess2(moraineM, 6)
e<-combProcess2(upperM, 6)
cbbPalette <- c("#D55E00", "#000000", "#0072B2")
a<-ggplot(data = a, aes(x=Time, y=value, color=series)) +
labs(y="Occupancy (%)", title="Big Meadows, Shenandoah National Park")  +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
b<-ggplot(data = b, aes(x=Time, y=value, color=series )  )  +
labs(y="Occupancy (%)", title="Elkmont, Great Smoky Mountains National Park")       +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
c<-ggplot(data = c, aes(x=Time, y=value, color=series )  ) +
labs(y="Occupancy (%)", title="Mather, Grand Canyon National Park")    +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
d<-ggplot(data = d, aes(x=Time, y=value, color=series )  ) +
labs(y="Occupancy (%)", title="Moraine, Rocky Mountain National Park")    +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
e<-ggplot(data = e, aes(x=Time, y=value, color=series )  )  +
labs(y="Occupancy (%)", title="Upper Pines, Yosemite National Park")   +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
source("~/Documents/Github/RIDB/grid_arrange_shared_legend.R")
pdf("forecasting6.", 16, 9)
grid_arrange_shared_legend(a, b, c, d, e, ncol=3, nrow=2)
dev.off()
pdf("forecasting6.pdf", 16, 9)
grid_arrange_shared_legend(a, b, c, d, e, ncol=3, nrow=2)
dev.off()
source("~/Documents/GitHub/RIDB/combProcess2.R")
b<-combProcess2(elkmontM, 12)
c<-combProcess2(matherM, 12)
a<-combProcess2(meadowsM, 12)
d<-combProcess2(moraineM, 12)
e<-combProcess2(upperM, 12)
cbbPalette <- c("#D55E00", "#000000", "#0072B2")
a<-ggplot(data = a, aes(x=Time, y=value, color=series)) +
labs(y="Occupancy (%)", title="Big Meadows, Shenandoah National Park")  +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
b<-ggplot(data = b, aes(x=Time, y=value, color=series )  )  +
labs(y="Occupancy (%)", title="Elkmont, Great Smoky Mountains National Park")       +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
c<-ggplot(data = c, aes(x=Time, y=value, color=series )  ) +
labs(y="Occupancy (%)", title="Mather, Grand Canyon National Park")    +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
d<-ggplot(data = d, aes(x=Time, y=value, color=series )  ) +
labs(y="Occupancy (%)", title="Moraine, Rocky Mountain National Park")    +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
e<-ggplot(data = e, aes(x=Time, y=value, color=series )  )  +
labs(y="Occupancy (%)", title="Upper Pines, Yosemite National Park")   +
geom_line(aes(y=gtemp , col='Real'), size=1.2, alpha=.9)  +
geom_line(aes(y=gtempl, col='Combination'), size=1.2, alpha=.5)    +
geom_line(aes(y=gtempa, col='SARIMA'), size=1.2, alpha=.5)    +
theme(panel.background = element_blank()) +
scale_y_continuous(breaks=seq(0,100,25)) +
scale_x_date(date_breaks = "2 month", date_labels = "%b %Y") +
scale_colour_manual(values=cbbPalette)
source("~/Documents/Github/RIDB/grid_arrange_shared_legend.R")
pdf(filename = "forecasting12.pdf" 16, 9)
pdf(filename = "forecasting12.pdf", 16, 9)
pdf("forecasting12.pdf", 16, 9)
grid_arrange_shared_legend(a, b, c, d, e, ncol=3, nrow=2)
dev.off()
